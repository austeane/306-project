hist(Salary)
hist(sqrt(Salary))
par(mfrow=c(1,2), mar=c(10, 10, 10, 10))
hist(Salary)
hist(sqrt(Salary))
par(mfrow=c(1,2), mar=c(2, 2, 2, 2))
hist(Salary)
hist(sqrt(Salary))
#First load the data set all as one
dat = read.csv("../data/20160401-Complete.csv");
attach(dat)
par(mfrow=c(1,2), mar=c(2, 2, 2, 2))
hist(Salary)
hist(sqrt(Salary))
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
detach(dat)
dat$SalaryRoot = sqrt(dat$Salary)
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
detach(dat)
modF = lm(SalaryRoot ~ G, data=datF)
ModF = lm(SalaryRoot ~ G, data=datF)
sModF
sModF = summary(ModF)
sModF
ModF = lm(SalaryRoot ~ G+A1+A2+P+iHSC+iSC, data=datF)
sModF = summary(ModF)
sModF
ModF = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC, data=datF)
sModF = summary(ModF)
sModF
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC, data=datF)
sModF = summary(ModF)
sModF
ModF = lm(Salary ~ ., data=datF)
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB_FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age, data=datF)
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age, data=datF)
sModF = summary(ModF)
sModF
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age, data=datF)
sModFSQ = summary(sModFSQ)
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
sModF
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModF = summary(ModF)
sModF
library(leaps)
ModFSS = regsubsets(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive")
sModFSS
ModFSS = regsubsets(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive")
sModFSS = summary(modFSS)
sModFSS = summary(ModFSS)
sModFSS
sModFSS$adjr2
?regsubsets
ModFSS = regsubsets(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModF = summary(ModF)
sModF
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
ModFSS = regsubsets(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
ModFSS = regsubsets(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
dat$SalaryLog = log(dat$Salary)
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
detach(dat)
library(leaps)
ModFSS = regsubsets(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
datF$SalaryLog
datF$Salary
which(datF$SalaryLog == 0)
which(datD$SalaryLog == 0)
dat[which(datD$SalaryLog == 0),]$Salary
dat[which(dat$SalaryLog == 0),]$Salary
dat[which(dat$Salary == 0),]$Salary
# Make anyone with a "0" salary NA
dat[which(dat$Salary == 0),]$Salary = NA
#Next, let's take a look at our response variable: Salary
par(mfrow=c(1,2), mar=c(2, 2, 2, 2))
hist(Salary)
#Square root might give a better distribution of wages
hist(sqrt(Salary))
dat$SalaryRoot = sqrt(dat$Salary)
dat$SalaryLog = log(dat$Salary)
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
detach(dat)
#Create a linear model using all of the data
# Make separate data groups for forwards vs. defense
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
#Create a linear model using all of the data
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModF = summary(ModF)
sModF
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
library(leaps)
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
hist(log(dat$Salary))
par(mfrow=c(1,3), mar=c(2, 2, 2, 2))
hist(dat$Salary)
#Square root might give a better distribution of wages
hist(sqrt(dat$Salary))
#Log might also give a better distribution
hist(log(dat$Salary))
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
#Create a linear model using all of the data
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModF = summary(ModF)
sModF
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
ModFL = lm(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFL = summary(ModFL)
sModFL
library(leaps)
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
sModFSS
sModFSS$adjr2
which.max(sModFSS$adjr2)
names(sModFSS)
sModFSS$obj
names(sModFSS$obj)
ModFL$residuals
resid(ModFL)
names(ModFL)
names(ModFL$residuals)
names(ModFL$residuals)
names(ModFL)
names(ModFL$residuals)
plot(datF$G, resid(lm(SalaryLog~G, data=datF)), ylab="Residuals", xlab="Goals")
datF$G
resid(lm(SalaryLog~G, data=datF))
datF$G
datF$SalaryLog
datF$G
nrow(datF$G)
length(datF$G)
length(resid(lm(SalaryLog~G, data=datF)))
mr1 = lm(SalaryLog~G, data=datF);
length(mr1$residuals)
na.omit(datF$G)
length(mr1$residuals)
length(na.omit(datF$G))
mr1 = lm(SalaryLog~G, data=datF, na.action = na.exclude());
mr1 = lm(SalaryLog~G, data=datF, na.action = "na.exclude");
length(mr1$residuals)
mr1 = lm(SalaryLog~G, data=datF, na.action = "na.ignore");
mr1 = lm(SalaryLog~G, data=datF, na.action = "na.omit");
length(mr1$residuals)
mr1 = lm(SalaryLog~G, data=datF);
length(na.omit(datF$G, datF$SalaryLog))
#First load the data set all as one
dat = read.csv("../data/20160401-Complete.csv");
# Any 0 salaries should be removed I suppose
dat = dat[-which(dat$Salary == 0),]
nrow(dat)
nrow(dat)
#Next, let's take a look at our response variable: Salary
par(mfrow=c(1,3), mar=c(2, 2, 2, 2))
hist(dat$Salary)
#Square root might give a better distribution of wages
hist(sqrt(dat$Salary))
#Log might also give a better distribution
hist(log(dat$Salary))
dat$SalaryRoot = sqrt(dat$Salary)
dat$SalaryLog = log(dat$Salary)
# Make separate data groups for forwards vs. defense
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
#Create a linear model using all of the data
ModF = lm(Salary ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModF = summary(ModF)
sModF
ModFSQ = lm(SalaryRoot ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
ModFL = lm(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFL = summary(ModFL)
sModFL
plot(datF$G, resid(lm(SalaryLog~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
par(mfrow=c(1,1))
par(mfrow=c(1,1))
plot(datF$G, resid(lm(SalaryLog~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G, resid(lm(SalaryLog~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$A1, resid(lm(SalaryLog~A1, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$A2, resid(lm(SalaryLog~A2, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
ModFSQ = lm(SalaryRoot ~ I(G^2)+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
ModFSQ = lm(SalaryRoot ~ G+I(G^2)+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF)
sModFSQ = summary(ModFSQ)
sModFSQ
plot(datF$G^2, resid(lm(SalaryLog~I(G^2), data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$A1, resid(lm(SalaryLog~A1, data=datF)), ylab="Residuals", xlab="Goals")
plot(datF$A1^2, resid(lm(SalaryLog~I(A1^2), data=datF)), ylab="Residuals", xlab="Goals")
plot(datF$A2, resid(lm(SalaryLog~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(SalaryLog~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(SalaryLog~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
dat$G60 = dat$G * 60 / dat$TOI
# Make separate data groups for forwards vs. defense
datF = dat[which(dat[3]=="F"),]
nrow(datF)
datD = dat[which(dat[3]=="D"),]
nrow(datD)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(Salary~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$G60^2, resid(lm(Salary~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryRoot~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
?plot
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour")
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
summary(lm(SalaryLog~I(G60^2), data=datF))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(Salary~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
summary(lm(SalaryLog~I(G60^2), data=datF))
summary(lm(SalaryLog~I(G60^2)+G60, data=datF))
summary(lm(SalaryLog~I(G60^2)+G60+G, data=datF))
summary(lm(SalaryLog~I(G60^2)+G60+G+TOI, data=datF))
summary(lm(SalaryLog~I(G60^2)+G60+G+TOI+Age, data=datF))
plot(datF$G60^2, resid(lm(Salary~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
summary(lm(Salary~I(G60^2)+G60+G+TOI+Age, data=datF))
summary(lm(SalaryLog~I(G60^2)+G60+G+TOI+Age, data=datF))
summary(lm(SalaryRoot~I(G60^2)+G60+G+TOI+Age, data=datF))
summary(lm(SalaryLog~I(G60^2)+G60+G+TOI+Age, data=datF))
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(Salary~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
summary(lm(SalaryLog~G60+G+TOI+Age, data=datF))
summary(lm(SalaryLog~G60+TOI+Age, data=datF))
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Second Assists", xlim=c(0, 400))
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
title="Goals"
title="Goals"
title("Goals")
# Plot some residuals off salary
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
title("Goals")
xlab("Hi")
title("Goals")
?title("Goals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
title(xlab="Goals", ylab="Residuals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
title(xlab="Goals", ylab="Residuals")
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
text(openweekendgross,gross,label=ST)
text(datF$G,resid(lm(Salary~G, data=datF)),label=ST)
text(datF$G,resid(lm(Salary~G, data=datF)),label="Hi")
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), row.lab="Residuals", xlab="Goals")
plot(datF$G, resid(lm(Salary~G, data=datF)), col.lab="Residuals", xlab="Goals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), col.lab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G, resid(lm(Salary~G, data=datF)), col.lab="Residuals", col.sub="Goals")
par(mfrow=c(1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), col.lab="Residuals", col.sub="Goals")
abline(0,0)
par(mfrow=c(1,1), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), col.lab="Residuals", col.sub="Goals")
par(mfrow=c(1,1), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), xlab="Residuals", ylab="Goals")
par(mfrow=c(4,4), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), xlab="Residuals", ylab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
par(mfrow=c(4,4), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
par(mfrow=c(3,3), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour^2", xlim=c(0,5))
abline(0,0)
par(mfrow=c(3,3), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour")
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour^2", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,2))
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour^2", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2")
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
summary(lm(SalaryLog~G60+TOI+Age, data=datF))
library(leaps)
ModFSS = regsubsets(SalaryLog ~ G+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
which.max(sModFSS$adjr2)
sModFSS
names(sModFSS)
names(sModFSS$obj)
ModFSS = regsubsets(SalaryLog ~ G+G60+A1+A2+iHSC+iSC+iCF+C...+F...+G...+CF+FF+ZSO+ZSD+AB+FO_W+FO_L+HIT+HIT.+PN+PN.+TOI+Age+ShotAttempts+ScoringChances+ShotsOnGoal+A3OnDirectGoals, data=datF, method="exhaustive", nvmax=20)
sModFSS = summary(ModFSS)
sModFSS$adjr2
which.max(sModFSS$adjr2)
sModFSS
which.max(sModFSS$adjr2)
sModFSS
names(sModFSS)
names(sModFSS$obj)
sModFSS$adjr2
summary(lm(SalaryLog~G60+TOI+Age, data=datF))
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists", xlim=c(0,50))
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2", xlim=c(0,50))
abline(0,0)
par(mfrow=c(3,3), mar=c(4,4,1,1))
plot(datF$G, resid(lm(Salary~G, data=datF)), ylab="Residuals", xlab="Goals")
abline(0,0)
plot(datF$G^2, resid(lm(Salary~I(G^2), data=datF)), ylab="Residuals", xlab="Goals^2")
abline(0,0)
plot(datF$G60, resid(lm(SalaryLog~G60, data=datF)), ylab="Residuals", xlab="Goals Per Hour", xlim=c(0,2))
abline(0,0)
plot(datF$G60^2, resid(lm(SalaryLog~I(G60^2), data=datF)), ylab="Residuals", xlab="Goals Per Hour^2", xlim=c(0,5))
abline(0,0)
plot(datF$A1, resid(lm(Salary~A1, data=datF)), ylab="Residuals", xlab="First Assists")
abline(0,0)
plot(datF$A1^2, resid(lm(Salary~I(A1^2), data=datF)), ylab="Residuals", xlab="First Assists^2", xlim=c(0,50))
abline(0,0)
plot(datF$A2, resid(lm(Salary~A2, data=datF)), ylab="Residuals", xlab="Second Assists")
abline(0,0)
plot(datF$Age, resid(lm(SalaryLog~Age, data=datF)), ylab="Residuals", xlab="Age")
abline(0,0)
plot(datF$TOI, resid(lm(SalaryLog~TOI, data=datF)), ylab="Residuals", xlab="Time on ice", xlim=c(0, 400))
abline(0,0)
